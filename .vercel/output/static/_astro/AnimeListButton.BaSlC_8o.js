import{v as N}from"./runtime-dom.esm-bundler.BZRa_mre.js";import{_ as O,t as l}from"./_plugin-vue_export-helper.DbbboyIR.js";import{g as u}from"./index.CH_iu5NA.js";import{p as s,s as C,t as r,x as L,v as b,u as k,F as M,y as A,w as c,A as j,q as i}from"./runtime-core.esm-bundler.DqDjC33v.js";const D=["planned","watching","watched","dropped"],H={planned:"text-blue-400",watching:"text-yellow-400",watched:"text-green-400",dropped:"text-red-400"},J={__name:"AnimeListButton",props:{animeId:String,session:Object,showStatus:Boolean,className:String},emits:["update-status"],setup(y,{expose:a,emit:d}){a();const e=y,g=d,h=c(null),t=c(null),m=c(!1),p=c(""),v=c(!1),w=c(null);let f;j(async()=>{const n=await(await fetch(`/api/users_animes.json?animeId=${e.animeId}`)).json();m.value=!!n?.anime_id,p.value=n?.status});function E(){clearTimeout(f),u.to(h.value,{opacity:1,y:0,pointerEvents:"auto",duration:.3,ease:"power2.out"})}function x(){f=setTimeout(()=>{u.to(h.value,{opacity:0,y:-10,pointerEvents:"none",duration:.2,ease:"power2.inOut"}),u.to(t.value,{rotate:0,duration:.6,ease:"power2.out"})},100)}function _(){v.value=!v.value,v.value?u.fromTo(w.value,{opacity:0,y:-10},{opacity:1,y:0,duration:.2,pointerEvents:"auto"}):u.to(w.value,{opacity:0,y:-10,duration:.2,pointerEvents:"none"})}function B(){u.to(t.value,{rotate:180,duration:.6,ease:"power2.out"})}async function I(o="planned"){try{(await fetch("/api/users_animes.json",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({animeId:e.animeId,status:o})})).ok&&(m.value=!0,p.value=o,l.success("Anime added correctly"),x())}catch(n){l.error("Error adding anime"),console.error("Error al agregar anime:",n)}}async function T(o){try{(await fetch("/api/users_animes.json",{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({animeId:e.animeId,status:o})})).ok&&(p.value=o,l.success("Status updated"),_(),g("update-status"))}catch(n){l.error("Error updating status"),console.error("Error al actualizar status:",n)}}async function z(){try{if((await fetch("/api/users_animes.json",{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({animeId:e.animeId})})).ok&&(m.value=!1,p.value="",l.success("Anime remove correctly"),e.showStatus)){const n=document.querySelector(`#anime-card-${e.animeId}`);n&&n.remove()}}catch(o){l.error("Error removing anime"),console.error("Error al eliminar anime:",o)}}const S={props:e,emits:g,menu:h,addButton:t,isAdded:m,currentStatus:p,showStatusMenu:v,statusMenu:w,get hoverTimeout(){return f},set hoverTimeout(o){f=o},showMenu:E,hideMenu:x,toggleStatusMenu:_,rotateButton:B,addAnime:I,updateStatus:T,removeAnime:z,ref:c,onMounted:j,get toast(){return l},get statuses(){return D},get statusColors(){return H},get gsap(){return u}};return Object.defineProperty(S,"__isScriptSetup",{enumerable:!1,value:!0}),S}},P={key:0,class:"relative"},q={ref:"statusMenu",class:"absolute z-50 w-36 mt-2 left-0 flex flex-col bg-black/80 text-white shadow-lg rounded-xl overflow-hidden opacity-0 pointer-events-none"},F=["onClick"],U=["data-id"],V=["data-id"],W={ref:"menu",class:"absolute top-8 right-0 w-40 pt-2 flex-col z-50 shadow-lg opacity-0 pointer-events-none"},G=["onClick","data-status"];function K(y,a,d,e,g,h){return i(),s("div",{class:k(`${d.className} flex items-center justify-between gap-4`)},[d.showStatus&&e.currentStatus?(i(),s("div",P,[r("button",{type:"button",onClick:e.toggleStatusMenu,class:k(`${e.statusColors[e.currentStatus]} border-2 background-blur-2xl hover:bg-black/80 text-sm font-medium capitalize px-3 py-1 rounded-full cursor-pointer`)},b(e.currentStatus),3),L(r("div",q,[y.status!==e.currentStatus?(i(!0),s(M,{key:0},A(e.statuses,t=>(i(),s("button",{key:t,onClick:m=>e.updateStatus(t),class:"w-full text-left px-3 py-2 hover:bg-white hover:text-black transition-colors cursor-pointer"},b(t.charAt(0).toUpperCase()+t.slice(1)),9,F))),128)):C("",!0)],512),[[N,e.showStatusMenu]])])):C("",!0),e.isAdded?(i(),s("button",{key:1,onClick:e.removeAnime,"data-id":d.animeId,"data-action":"remove",class:"anime-list-button max-w-fit flex items-center justify-center p-2 text-black bg-white/90 hover:bg-zinc-200 rounded-lg cursor-pointer transition-colors"},a[1]||(a[1]=[r("svg",{class:"size-4",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[r("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),r("path",{d:"M5 12l5 5l10 -10"})],-1)]),8,U)):(i(),s("div",{key:2,class:"relative",onMouseenter:e.showMenu,onMouseleave:e.hideMenu},[r("button",{ref:"addButton",type:"button","data-id":d.animeId,"data-action":"add",class:"anime-list-button max-w-fit flex items-center justify-center p-2 text-white bg-black/90 hover:bg-white/90 hover:text-black rounded-lg cursor-pointer transition-colors",onMouseenter:e.rotateButton,onClick:a[0]||(a[0]=t=>e.addAnime())},a[2]||(a[2]=[r("svg",{class:"size-4",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[r("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),r("path",{d:"M12 5l0 14"}),r("path",{d:"M5 12l14 0"})],-1)]),40,V),r("div",W,[(i(!0),s(M,null,A(e.statuses,t=>(i(),s("button",{key:t,onClick:m=>e.addAnime(t),"data-status":t,class:k(["w-full bg-black/80 hover:bg-white/80 hover:text-black text-white cursor-pointer px-2 py-1",{"rounded-t-xl":t==="planned","rounded-b-xl":t==="dropped"}])},b(t.charAt(0).toUpperCase()+t.slice(1)),11,G))),128))],512)],32))],2)}const Z=O(J,[["render",K]]);export{Z as A,D as s};
